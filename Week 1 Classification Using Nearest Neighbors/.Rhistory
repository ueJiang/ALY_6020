ttt %>% group_by(YEAR, MONTH) %>% summarise_each(funs(mean))
ttt %>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
ttt %>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
ttt$jjj <- paste(ttt$YEAR, ttt$MONTH)
ttt
ttt %>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
tt <- ttt %>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
tt$jjj <- paste(tt$YEAR, tt$MONTH)
tt
tt$jjj
ttt <- crime_data[crime_data$OFFENSE_DESCRIPTION == "LARCENY THEFT FROM MV - NON-ACCESSORY", ]
ttt%>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
shiny::runApp()
shiny::runApp()
tt
tt
shiny::runApp()
ttt%>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
tt <- ttt%>% group_by(YEAR, MONTH) %>% summarise_each(funs(length))
tt
tt$yearmonth <- paste(tt$YEAR, tt$MONTH)
tt
tt$yearmonth
tt
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
exit
exit;
getwd()
shiny::runApp()
shiny::runApp()
pwd
exit;
quit()
quit;
shiny::runApp()
shiny::runApp()
shiny::runApp()
tt
tt$yearmonth
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
tt
tt$yearmonth
ggplot(data = tt, aes(x=yearmonth, y=Count)) + geom_line() + ggtitle("Number of Lacerny by Month and Year") + theme(plot.title = element_text(face = 'bold')) + theme(plot.title = element_text(hjust = 0.5)) + geom_point(size = 4) + scale_x_discrete(breaks = c("2016 1", "2017 1", "2018 1", "2019 1", "2020 1"), labels = c("2016", "2017", "2018", "2019", "2020"))
tt$OFFENSE_CODE
ggplot(data = tt, aes(x=yearmonth, y=OFFENSE_CODE)) + geom_line() + ggtitle("Number of Lacerny by Month and Year") + theme(plot.title = element_text(face = 'bold')) + theme(plot.title = element_text(hjust = 0.5)) + geom_point(size = 4) + scale_x_discrete(breaks = c("2016 1", "2017 1", "2018 1", "2019 1", "2020 1"), labels = c("2016", "2017", "2018", "2019", "2020"))
ggplot(data = tt, aes(x=yearmonth, y=OFFENSE_CODE)) + geom_line() + geom_point() + scale_x_discrete(breaks = c("2016 1", "2017 1", "2018 1", "2019 1", "2020 1"), labels = c("2016", "2017", "2018", "2019", "2020"))
tt$yearmonth <- as.numeric(paste(ttt$YEAR, ttt$MONTH))
tt
tt$yearmonth
tt$yearmonth <- as.numeric(as.character(tt$yearmonth))
tt$yearmonth
tt$yearmonth <- as.numeric(paste(ttt$YEAR, ttt$MONTH, sep = ""))
tt$yearmonth <- paste(ttt$YEAR, ttt$MONTH, sep = "")
paste(ttt$YEAR, ttt$MONTH)
paste(ttt$YEAR, ttt$MONTH, sep="")
tt$yearmonth <- paste(ttt$YEAR, ttt$MONTH)
paste(ttt$YEAR, ttt$MONTH)
as.yearmon(paste(ttt$YEAR, ttt$MONTH), "%Y %m")
install.packages("zoo")
library(zoo)
as.yearmon(paste(ttt$YEAR, ttt$MONTH), "%Y %m")
shiny::runApp()
shiny::runApp()
tt$yearmonth <- as.yearmon(paste(ttt$YEAR, ttt$MONTH), "%Y %m")
tt$ym <- as.yearmon(paste(ttt$YEAR, ttt$MONTH), "%Y %m")
ttt$ym <- as.yearmon(paste(ttt$YEAR, ttt$MONTH), "%Y %m")
ttt$yearmonth <- as.yearmon(paste(ttt$YEAR, ttt$MONTH), "%Y %m")
tt <-  aggregate(ttt$yearmonth, by=list(ttt$yearmonth), FUN=length)
colnames(tt) <- c("yearmonth", "Count")
tt$yearmonth
ggplot(data = tt, aes(x=yearmonth, y=Count)) + geom_line() + ggtitle("Number of Lacerny by Month and Year") + theme(plot.title = element_text(face = 'bold')) + theme(plot.title = element_text(hjust = 0.5)) + geom_point(size = 4) + scale_x_discrete(breaks = c(as.yearmon("Jan 2016"), as.yearmon("Jan 2017"), as.yearmon("Jan 2018"), as.yearmon("Jan 2019"), as.yearmon("Jan 2020")), labels = c("2016", "2017", "2018", "2019", "2020"))
})
ggplot(data = tt, aes(x=yearmonth, y=Count)) + geom_line() + ggtitle("Number of Lacerny by Month and Year") + theme(plot.title = element_text(face = 'bold')) + theme(plot.title = element_text(hjust = 0.5)) + geom_point(size = 4) + scale_x_discrete(breaks = c(as.yearmon("Jan 2016"), as.yearmon("Jan 2017"), as.yearmon("Jan 2018"), as.yearmon("Jan 2019"), as.yearmon("Jan 2020")), labels = c("2016", "2017", "2018", "2019", "2020"))
ggplot(data = tt, aes(x=yearmonth, y=Count)) + geom_line() + ggtitle("Number of Lacerny by Month and Year") + theme(plot.title = element_text(face = 'bold')) + theme(plot.title = element_text(hjust = 0.5)) + geom_point(size = 4))
ggplot(data = tt, aes(x=yearmonth, y=Count)) + geom_line() + ggtitle("Number of Lacerny by Month and Year") + theme(plot.title = element_text(face = 'bold')) + theme(plot.title = element_text(hjust = 0.5)) + geom_point(size = 4)
shiny::runApp()
shiny::runApp()
shiny::runApp()
install.packages('shinydashboard')
library(shinydashboard)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
setwd(/Users/yuyizhang/FCR/NEU/CPS/Analytics_2018/ALY 6020_Predictive Analytics/Week 1)
setwd('/Users/yuyizhang/FCR/NEU/CPS/Analytics_2018/ALY 6020_Predictive Analytics/Week 1')
library(class)
library(gmodels)
# Step 2. exploring and preparing the data
sgc <- read.csv('german.data-numeric.csv', stringsAsFactors = FALSE)
table(sgc$Credit.result)
sgc$Credit.result <- factor(sgc$Credit.result, levels = c("1", "2"), labels = c("Good", "Bad"))
round(prop.table(table(sgc$Credit.result))*100, digits = 1)
summary(sgc[c("Duration.in.month", "Credit.history", "Credit.amount")])
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
# creating training and test datasets
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
# Step 4 – evaluating model performance
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq=FALSE)
summary(sgc[c("Duration.in.month", "Credit.history", "Credit.amount", "Property")])
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
# creating training and test datasets
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
# Step 4 – evaluating model performance
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq=FALSE)
summary(sgc[c("Status.of.existing.checking.account", Duration.in.month", "Credit.history")])
summary(sgc[c("Status.of.existing.checking.account", "Duration.in.month", "Credit.history")])
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
# creating training and test datasets
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
# Step 4 – evaluating model performance
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq=FALSE)
summary(sgc[c("Status.of.existing.checking.account", "Duration.in.month", "Credit.history", "Credit.amount")])
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
# creating training and test datasets
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
# Step 4 – evaluating model performance
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq=FALSE)
library(class)
library(gmodels)
# Step 2. exploring and preparing the data
wbcd <- read.csv('wisc_bc_data.csv', stringsAsFactors = FALSE)
str(wbcd)
wbcd <- wbcd[-1]
str(wbcd)
table(wbcd$Diagnosis)
wbcd$Diagnosis <- factor(wbcd$Diagnosis, levels = c("B", "M"), labels = c("Benign", "Malignant"))
round(prop.table(table(wbcd$Diagnosis))*100, digits = 1)
summary(wbcd[c("Radius", "Area", "Smoothness")])
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
normalize(c(1, 2, 3, 4, 5))
normalize(c(10, 20, 30, 40, 50))
wbcd_n <- as.data.frame(lapply(wbcd[2:31], normalize))
summary(wbcd_n$Area)
# creating training and test datasets
wbcd_train <- wbcd_n[1:469, ]
wbcd_test <- wbcd_n[470:569, ]
wbcd_train_labels <- wbcd[1:469, 1]
wbcd_test_labels <- wbcd[470:569, 1]
# Step 3 – training a model on the data
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 21)
# Step 4 – evaluating model performance
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
# Step 5 – improving model performance
# Transformation – z-score standardization
wbcd_z <- as.data.frame(scale(wbcd[-1]))
summary(wbcd_z$Area)
wbcd_train <- wbcd_z[1:469, ]
wbcd_test <- wbcd_z[470:569, ]
wbcd_train_labels <- wbcd[1:469, 1]
wbcd_test_labels <- wbcd[470:569, 1]
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 21)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq = FALSE)
# Testing alternative values of k
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 1)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 5)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 11)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 15)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 27)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
# Step 2. exploring and preparing the data
sgc <- read.csv('german.data-numeric.csv', stringsAsFactors = FALSE)
table(sgc$Credit.result)
sgc$Credit.result <- factor(sgc$Credit.result, levels = c("1", "2"), labels = c("Good", "Bad"))
round(prop.table(table(sgc$Credit.result))*100, digits = 1)
str(sgc)
table(sgc$Credit.result)
sgc$Credit.result <- factor(sgc$Credit.result, levels = c("1", "2"), labels = c("Good", "Bad"))
round(prop.table(table(sgc$Credit.result))*100, digits = 1)
str(sgc)
str(sgc)
# Step 2. exploring and preparing the data
sgc <- read.csv('german.data-numeric.csv', stringsAsFactors = FALSE)
str(sgc)
table(sgc$Credit.result)
sgc$Credit.result <- factor(sgc$Credit.result, levels = c("1", "2"), labels = c("Good", "Bad"))
round(prop.table(table(sgc$Credit.result))*100, digits = 1)
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
summary(sgc[c("Status.of.existing.checking.account", "Duration.in.month", "Credit.history", "Credit.amount")])
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
# creating training and test datasets
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
# Step 4 – evaluating model performance
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq=FALSE)
# Step 5 – improving model performance
## Transformation – z-score standardization
sgc_z <- as.data.frame(scale(sgc[-25]))
summary(sgc_z$Duration.in.month)
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
## Testing alternative values of k
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 1)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 5)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 10)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 15)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 20)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 25)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 30)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 35)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 40)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 45)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
## Testing alternative values of k
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 1)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 5)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 10)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 15)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 20)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 25)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 30)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 35)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 40)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 45)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
# Step 2. exploring and preparing the data
wbcd <- read.csv('wisc_bc_data.csv', stringsAsFactors = FALSE)
str(wbcd)
wbcd <- wbcd[-1]
str(wbcd)
table(wbcd$Diagnosis)
wbcd$Diagnosis <- factor(wbcd$Diagnosis, levels = c("B", "M"), labels = c("Benign", "Malignant"))
round(prop.table(table(wbcd$Diagnosis))*100, digits = 1)
summary(wbcd[c("Radius", "Area", "Smoothness")])
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
normalize(c(1, 2, 3, 4, 5))
normalize(c(10, 20, 30, 40, 50))
wbcd_n <- as.data.frame(lapply(wbcd[2:31], normalize))
summary(wbcd_n$Area)
# creating training and test datasets
wbcd_train <- wbcd_n[1:469, ]
wbcd_test <- wbcd_n[470:569, ]
wbcd_train_labels <- wbcd[1:469, 1]
wbcd_test_labels <- wbcd[470:569, 1]
# Step 3 – training a model on the data
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 21)
# Step 4 – evaluating model performance
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
# Testing alternative values of k
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 1)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 5)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 11)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 15)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 27)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
wbcd_test_pred <- knn(train = wbcd_train, test = wbcd_test,
cl = wbcd_train_labels, k = 20)
CrossTable(x = wbcd_test_labels, y = wbcd_test_pred,
prop.chisq=FALSE)
# Step 2. exploring and preparing the data
sgc <- read.csv('german.data-numeric.csv', stringsAsFactors = FALSE)
table(sgc$Credit.result)
sgc$Credit.result <- factor(sgc$Credit.result, levels = c("1", "2"), labels = c("Good", "Bad"))
round(prop.table(table(sgc$Credit.result))*100, digits = 1)
summary(sgc[c("Status.of.existing.checking.account", "Duration.in.month", "Credit.history", "Credit.amount")])
# normalizing numeric data
normalize <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
sgc_n <- as.data.frame(lapply(sgc[1:24], normalize))
summary(sgc_n$Duration.in.month)
# creating training and test datasets
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 32)
# Step 3 – training a model on the data
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 28)
# Step 4 – evaluating model performance
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq=FALSE)
# Step 5 – improving model performance
## Transformation – z-score standardization
sgc_z <- as.data.frame(scale(sgc[-25]))
summary(sgc_z$Duration.in.month)
sgc_train <- sgc_n[1:800, ]
sgc_test <- sgc_n[801:1000, ]
sgc_train_labels <- sgc[1:800, 25]
sgc_test_labels <- sgc[801:1000, 25]
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 28)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
## Testing alternative values of k
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 1)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 5)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 10)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 15)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 20)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 25)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 30)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 35)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 40)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
sgc_test_pred <- knn(train = sgc_train, test = sgc_test,
cl = sgc_train_labels, k = 45)
CrossTable(x = sgc_test_labels, y = sgc_test_pred,
prop.chisq = FALSE)
